---
- name: Configure zsh
  ansible.builtin.blockinfile:
    path: "{{ ansible_env.HOME }}/.zshrc"
    marker: "# {mark} ANSIBLE MANAGED BLOCK FOR RUSTUP"
    prepend_newline: true
    append_newline: true
    block: |
      . "{{ ansible_env.HOME }}/.cargo/env"

- name: Install rustup
  ansible.builtin.shell:
    cmd: curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
    creates: "{{ ansible_env.HOME }}/.cargo/bin/rustup"
